# Squeez - 壓縮子資料夾工具

當資料夾中有太多子資料夾時，自動將每個子資料夾壓縮成 zip 檔案並刪除原本的資料夾。

## 功能特色

- ✅ 自動壓縮所有子資料夾
- ✅ **多重安全驗證機制，確保檔案不遺失**
  - 壓縮前計算原始檔案數量
  - 壓縮後驗證 ZIP 檔案完整性
  - 驗證 ZIP 中的檔案數量與原始一致
  - 只有驗證通過才會刪除原始資料夾
- ✅ 圖形介面選擇資料夾路徑
- ✅ 壓縮完成後自動刪除原始資料夾
- ✅ 支援設定最少子資料夾數量門檻
- ✅ 提供模擬模式（dry-run）預覽操作
- ✅ 跳過已存在的壓縮檔案
- ✅ 詳細的執行報告和進度顯示

## 系統需求

- Python 3.7 或更高版本
- 無需額外安裝套件（使用 Python 標準函式庫）

## 安裝

```bash
# 克隆專案
git clone <repository-url>
cd squeez

# 無需安裝額外套件
```

## 使用方法

### 基本用法

```bash
# 使用圖形介面選擇資料夾（推薦）
python src/squeez.py

# 壓縮當前目錄的所有子資料夾
python src/squeez.py .

# 壓縮指定目錄的所有子資料夾
python src/squeez.py C:\MyFolder
```

### 進階選項

```bash
# 只在子資料夾數量 >= 5 時才執行
python src/squeez.py . --min-count 5

# 模擬執行，預覽會發生什麼，不實際壓縮和刪除
python src/squeez.py . --dry-run

# 組合使用
python src/squeez.py C:\MyFolder --min-count 3 --dry-run
```

### 參數說明

| 參數 | 說明 | 預設值 |
|------|------|--------|
| `directory` | 要處理的目錄路徑 | `.` (當前目錄) |
| `--min-count` | 最少子資料夾數量才執行壓縮 | `1` |
| `--dry-run` | 模擬執行，不實際壓縮和刪除 | `False` |

## 使用範例

### 範例 1：基本使用

假設你有以下結構：

```
MyFolder/
├── Project1/
│   ├── file1.txt
│   └── file2.txt
├── Project2/
│   └── data.csv
└── Project3/
    └── image.png
```

執行：
```bash
python src/squeez.py MyFolder
```

結果：
```
MyFolder/
├── Project1.zip
├── Project2.zip
└── Project3.zip
```

### 範例 2：使用模擬模式

先預覽會發生什麼：

```bash
python src/squeez.py MyFolder --dry-run
```

輸出：
```
==================================================
Squeez - 壓縮子資料夾工具
==================================================

📁 找到 3 個子資料夾
📍 目標目錄: C:\Users\YourName\MyFolder

🔍 模擬模式 - 不會實際壓縮或刪除檔案

處理中: Project1 ✓ (模擬)
處理中: Project2 ✓ (模擬)
處理中: Project3 ✓ (模擬)

==================================================
✅ 成功: 3 個
==================================================
```

### 範例 3：設定門檻值

只在子資料夾數量達到 5 個以上才執行：

```bash
python src/squeez.py MyFolder --min-count 5
```

## 安全機制

🔒 **多重保護，確保檔案不遺失**

本工具採用嚴格的安全驗證機制：

1. **壓縮前檢查**
   - 計算原始資料夾中的檔案總數
   - 確認資料夾不是空的

2. **壓縮後驗證**
   - 使用 ZIP 內建的 `testzip()` 驗證檔案完整性
   - 比對 ZIP 中的檔案數量與原始檔案數量
   - 確認所有檔案都正確壓縮

3. **刪除前確認**
   - 只有當 ZIP 檔案完全驗證通過，才會刪除原始資料夾
   - 如果驗證失敗，會自動刪除不完整的 ZIP 檔案，保留原始資料夾

4. **錯誤處理**
   - 壓縮失敗：刪除不完整的 ZIP 檔案，保留原始資料夾
   - 驗證失敗：刪除損壞的 ZIP 檔案，保留原始資料夾
   - 刪除失敗：保留 ZIP 檔案和原始資料夾，提示手動處理

## 注意事項

⚠️ **重要提醒**

1. 壓縮後會**永久刪除**原始資料夾，請確保：
   - 先使用 `--dry-run` 模式預覽
   - 建議先在測試資料夾上試用
   
2. 如果壓縮檔案已存在，會跳過該資料夾的處理

3. 只處理**直接子資料夾**，不會遞迴處理子資料夾中的子資料夾

4. 本工具已內建完整性驗證，確保檔案不會遺失

## 錯誤處理

程式具備完整的錯誤處理機制：

- ✅ 目錄不存在時會顯示錯誤訊息
- ✅ 壓縮失敗時保留原始資料夾
- ✅ 刪除失敗時保留壓縮檔案和原始資料夾
- ✅ 已存在的壓縮檔案會自動跳過

## 輸出訊息說明

| 符號 | 說明 |
|------|------|
| ✓ | 成功完成 |
| ✓ (模擬) | 模擬模式成功 |
| ❌ | 操作失敗 |
| ⚠️ | 警告訊息 |
| ℹ️ | 資訊訊息 |
| 📁 | 資料夾資訊 |
| 📍 | 路徑資訊 |
| 🔍 | 模擬模式 |

## 授權

MIT License

## 作者

Created for efficient folder management and organization.

